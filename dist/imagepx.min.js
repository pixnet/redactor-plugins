if(!RedactorPlugins)var RedactorPlugins={};!function(a){RedactorPlugins.imagepx=function(){return{init:function(){this.modal.addCallback("imageEdit",a.proxy(this.imagepx.imageEdit,this))},imageEdit:function(){function b(a){var b=a.match(/\d+/);return b?parseInt(b[0]):0}function c(c){if(h.val()){o.width(h.val()),n=!0;var d=b(h.val());d>0&&o.attr({width:d})}else o.width("");if(i.val()){o.height(i.val()),n=!0;var e=b(i.val());e>0&&o.attr({height:e})}else o.height("");l.val()&&o.attr("src",l.val()),n&&!r&&a(".redactor-modal-close-btn")[0]&&(r=!0),c?(a("#redactor-modal-overlay").addClass("preview"),a("#redactor-modal").css({background:"rgba(255,255,255,0.667)"}).find("#redactor-modal-image-edit").css({background:"transparent"}),a("#redactor-modal-overlay").css({backgroundImage:"url("+o.attr("src")+")",backgroundSize:(h.val()?a.isNumeric(h.val())?h.val()+"px":h.val():"auto")+" "+(i.val()?a.isNumeric(i.val())?i.val()+"px":i.val():"auto")})):(a("#redactor-modal-overlay").removeClass("preview"),a("#redactor-modal").css({background:g[0]}).find("#redactor-modal-image-edit").css({background:g[1]}),a("#redactor-modal-overlay").css({backgroundImage:"",backgroundSize:""}))}function d(){_t=p.clone(),o.replaceWith(_t),o=null,o=_t,o.attr("style",q).css({opacity:""}),e.code.sync(),e.observe.load()}var e=this,f=a("#redactor-modal-body > section").append(a(document.createElement("div")).addClass("image-edit-dimensions")).find(".image-edit-dimensions"),g=[a("#redactor-modal").css("background"),a("#redactor-modal-image-edit").css("background")],h=a(document.createElement("input")).attr("type","text").attr("min","0").attr("maxlength","8").attr("pattern","d+(px|%|)").attr("data-redactor-deminsion-axis","x").attr("name","redactor-imageEdit-image-width").attr("id","redactor-imageEdit-image-width"),i=a(document.createElement("input")).attr("type","text").attr("min","0").attr("maxlength","8").attr("pattern","d+(px|%|)").attr("data-redactor-deminsion-axis","y").attr("name","redactor-imageEdit-image-height").attr("id","redactor-imageEdit-image-height"),j=a(document.createElement("input")).attr("disabled","disabled").attr("type","checkbox").attr("id","redactor-imageEdit-image-preview"),k=a(document.createElement("label")).attr("for","redactor-imageEdit-image-preview").text(this.opts.curLang.previewDimensions||"Preview Dimensions"),l=a(document.createElement("input")).attr("type","text").attr("name","redactor-imageEdit-image-src").attr("id","redactor-imageEdit-image-src"),m=a(document.createElement("label")).attr("for","redactor-imageEdit-image-src").text(this.opts.curLang.imageLink||"Image Link");k.prepend(j),m.append(l),a("#redactor-modal-body > section").prepend(a(document.createElement("div")).addClass("redactor-imageEdit-image-link").append(m)),f.append([a(document.createElement("div")).addClass("option").addClass("redactor-imageEdit-image-width").append(a(document.createElement("label")).attr("for","redactor-imageEdit-image-width").text(this.opts.curLang.width||"Width"),h),a(document.createElement("div")).addClass("option").addClass("redactor-imageEdit-image-height").append(a(document.createElement("label")).attr("for","redactor-imageEdit-image-height").text(this.opts.curLang.height||"Height"),i),a(document.createElement("div")).addClass("option").addClass("redactor-imageEdit-image-preview").append(k)]);var n,o=a("#redactor-image-box").children("img"),p=(o.parent(),o.clone().css("opacity","")),q=o.attr("style")||"",r=(a("#image-edit-dimensions").addClass("scalable"),!1),s=o.prop("style"),t=o.attr("src");s&&(s.width&&h.val(s.width),s.height&&i.val(s.height)),l.val(t||""),a.each([h,i,l],function(b,d){a(this).on("change keyup",function(a){h.val()||i.val()?j.removeAttr("disabled"):j.attr("disabled","disabled"),c(j.is(":checked"))})}),j.on("change",function(b){var d=a(this).is(":checked");c(d)}),e.$modalClose.on("click.redactor-modal",a.proxy(function(){d()},this)),a("#redactor-modal").click(function(b){a(b.target).hasClass("redactor-modal-close-btn")&&d()})}}}}(jQuery);